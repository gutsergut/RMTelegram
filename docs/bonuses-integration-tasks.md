# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è RadicalMart Bonuses —Å Telegram WebApp

> **–°—Ç–∞—Ç—É—Å**: –í —Ä–∞–±–æ—Ç–µ
> **–¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø**: 3.2 ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞
> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-11-28

---

## üìã –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã

–ü–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–µ–π:
1. –£—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ UX/–¥–∏–∑–∞–π–Ω—É
2. –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–∞
3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
5. –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–µ

---

## –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã –±–æ–Ω—É—Å–æ–≤

### –¢–∞–±–ª–∏—Ü—ã –ë–î
- `#__radicalmart_bonuses_codes` ‚Äî –ü—Ä–æ–º–æ–∫–æ–¥—ã (–≤–∫–ª—é—á–∞—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ)
- `#__radicalmart_bonuses_points` ‚Äî –ò—Å—Ç–æ—Ä–∏—è –±–∞–ª–ª–æ–≤ (–Ω–∞—á–∏—Å–ª–µ–Ω–∏—è/—Å–ø–∏—Å–∞–Ω–∏—è)
- `#__radicalmart_bonuses_referrals` ‚Äî –°–≤—è–∑–∏ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ (user_id ‚Üí parent_id)
- `#__radicalmart_bonuses_referrals_logs` ‚Äî –õ–æ–≥–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ö–ª—é—á–µ–≤—ã–µ —Ö–µ–ª–ø–µ—Ä—ã (Administrator)
- `PointsHelper` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –±–∞–ª–ª–∞–º–∏ (–±–∞–ª–∞–Ω—Å, –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ, –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è)
- `CodesHelper` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏ (–ø–æ–∏—Å–∫, –≤–∞–ª–∏–¥–∞—Ü–∏—è, –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ)
- `ReferralHelper` ‚Äî —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (—Å–≤—è–∑–∏, –ª–æ–≥–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
- `DiscountHelper` ‚Äî —Ä–∞—Å—á—ë—Ç —Å–∫–∏–¥–æ–∫ –Ω–∞ —Ç–æ–≤–∞—Ä—ã

### –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ Site Views
- `Points` ‚Äî –ò—Å—Ç–æ—Ä–∏—è –±–∞–ª–ª–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `Codes` ‚Äî –ü—Ä–æ–º–æ–∫–æ–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `Referrals` ‚Äî –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ (–∫–æ–¥—ã, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ RadicalMart Bonuses (–∏–∑ com_radicalmart.config.xml)

### –ë–∞–ª–ª—ã (bonuses_points)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | Default |
|----------|----------|---------|
| `bonuses_points_enabled` | –í–∫–ª—é—á–µ–Ω—ã –ª–∏ –±–∞–ª–ª—ã | `1` |
| `bonuses_points_non_discount_products` | –ë–∞–ª–ª—ã –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ –±–µ–∑ —Å–∫–∏–¥–∫–∏ | `0` |
| `bonuses_points_statuses` | –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–ª–ª–∞–º–∏ | `[]` |
| `bonuses_provider` | –ü—Ä–æ–≤–∞–π–¥–µ—Ä —Ä–∞—Å—á—ë—Ç–∞ –±–∞–ª–ª–æ–≤ | `standard` |
| `bonuses_points_instant` | –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ | `1` |
| `bonuses_points_precision` | –¢–æ—á–Ω–æ—Å—Ç—å (–∑–Ω–∞–∫–∏ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π) | `0` |
| `rounding` | –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ: round/ceil/floor | `round` |
| `bonuses_points_accrual_statuses` | –°—Ç–∞—Ç—É—Å—ã –¥–ª—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è | `[]` |
| `bonuses_points_accrual_timeout` | –¢–∞–π–º–∞—É—Ç –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è | `0 days` |
| `bonuses_points_accrual_formula_from` | –†–∞—Å—á—ë—Ç –æ—Ç: base/final | `base` |
| `bonuses_points_accrual_formula_{currency}` | –§–æ—Ä–º—É–ª–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –ø–æ –≤–∞–ª—é—Ç–µ | ‚Äî |
| `bonuses_points_withdraw_statuses` | –°—Ç–∞—Ç—É—Å—ã –¥–ª—è —Å–ø–∏—Å–∞–Ω–∏—è | `[]` |
| `bonuses_points_withdraw_formula_{currency}` | –§–æ—Ä–º—É–ª–∞ —Å–ø–∏—Å–∞–Ω–∏—è (–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –±–∞–ª–ª–æ–≤ –≤ –¥–µ–Ω—å–≥–∏) | `1=1` |
| `bonuses_points_refund_statuses` | –°—Ç–∞—Ç—É—Å—ã –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –±–∞–ª–ª–æ–≤ | `[]` |

### –ü—Ä–æ–º–æ–∫–æ–¥—ã (bonuses_codes)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | Default |
|----------|----------|---------|
| `bonuses_codes_enabled` | –í–∫–ª—é—á–µ–Ω—ã –ª–∏ –ø—Ä–æ–º–æ–∫–æ–¥—ã | `1` |
| `bonuses_codes_guest` | –ü—Ä–æ–º–æ–∫–æ–¥—ã –¥–ª—è –≥–æ—Å—Ç–µ–π | `1` |
| `bonuses_codes_non_discount_products` | –î–ª—è —Ç–æ–≤–∞—Ä–æ–≤ –±–µ–∑ —Å–∫–∏–¥–∫–∏ | `0` |
| `bonuses_codes_statuses` | –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤ | `[]` |
| `bonuses_codes_generation_length` | –î–ª–∏–Ω–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–≥–æ –∫–æ–¥–∞ | `8` |
| `bonuses_codes_cookies_enabled` | –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ cookies | `1` |
| `bonuses_codes_cookies_selector` | –ò–º—è cookie | `rbc` |
| `bonuses_codes_buy_enabled` | –ü–æ–∫—É–ø–∫–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ | `1` |
| `bonuses_codes_buy_statuses` | –°—Ç–∞—Ç—É—Å—ã –¥–ª—è –ø–æ–∫—É–ø–∫–∏ | `[]` |

### –†–µ—Ñ–µ—Ä–∞–ª—ã (bonuses_referral)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | Default |
|----------|----------|---------|
| `bonuses_referral_enabled` | –í–∫–ª—é—á–µ–Ω—ã –ª–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—ã | `1` |
| `bonuses_referral_access` | –ì—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | `[]` |
| `bonuses_referral_codes_enabled` | –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –∫–æ–¥—ã | `1` |
| `bonuses_referral_codes_custom_code` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–¥–∞—Ç—å –∫–æ–¥ | `1` |
| `bonuses_referral_codes_limit` | –õ–∏–º–∏—Ç –∫–æ–¥–æ–≤ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | `1` |
| `bonuses_referral_codes_expires_timeout` | –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∫–æ–¥–∞ | ‚Äî |
| `bonuses_referral_orders_accrual_from` | –ö–æ–º—É –Ω–∞—á–∏—Å–ª—è—Ç—å: referral/customer | `customer` |
| `bonuses_referral_orders_accrual_statuses` | –°—Ç–∞—Ç—É—Å—ã –¥–ª—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è | `[]` |
| `bonuses_referral_orders_accrual_timeout` | –¢–∞–π–º–∞—É—Ç –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è | `0 days` |
| `bonuses_referral_orders_accrual_formula_from` | –†–∞—Å—á—ë—Ç –æ—Ç: base/final | `base` |
| `bonuses_referral_orders_refund_statuses` | –°—Ç–∞—Ç—É—Å—ã –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ | `[]` |

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã PointsHelper
```php
// –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å –±–∞–ª–ª–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞
PointsHelper::getCustomerPoints(int $customerId): float

// –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –±–∞–ª–ª—ã –≤ –¥–µ–Ω—å–≥–∏ (–ø–æ —Ñ–æ—Ä–º—É–ª–µ bonuses_points_withdraw_formula_{currency})
PointsHelper::convertToMoney(float $points, string $currencyCode): float

// –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–µ–Ω—å–≥–∏ –≤ –±–∞–ª–ª—ã
PointsHelper::convertToPoints(float $money, string $currencyCode): float

// –û—á–∏—Å—Ç–∏—Ç—å/–æ–∫—Ä—É–≥–ª–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –±–∞–ª–ª–æ–≤ (—É—á–∏—Ç—ã–≤–∞–µ—Ç precision –∏ rounding)
PointsHelper::clean(mixed $value): float

// –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –æ –±–∞–ª–ª–∞—Ö (–Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ/—Å–ø–∏—Å–∞–Ω–∏–µ)
PointsHelper::createRecord(int $customer, float $points, ?string $context, array $data): int|false
```

---

## –ó–∞–¥–∞—á–∏ –Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –±–∞–ª–ª–æ–≤

#### 1.1 –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –±–∞–ª–ª–æ–≤ –≤ –ø—Ä–æ—Ñ–∏–ª–µ
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-28)

**–†–µ—à–µ–Ω–∏—è –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º**:
- –ë–∞–ª–∞–Ω—Å –≤ **–æ—Ç–¥–µ–ª—å–Ω–æ–º –±–ª–æ–∫–µ** (uk-card)
- –§–æ—Ä–º–∞—Ç: –≤–∞—Ä–∏–∞–Ω—Ç A "X –±–∞–ª–ª–æ–≤ (= Y ‚ÇΩ)"
- –°—Å—ã–ª–∫–∞ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—é ‚Äî —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –±–∞–ª–ª–æ–≤ > 0
- –ü—Ä–∏ 0 –±–∞–ª–ª–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "0 –±–∞–ª–ª–æ–≤" –±–µ–∑ —Å—Å—ã–ª–∫–∏

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:
- [x] `ProfileView::loadPointsBalance()` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –±–∞–ª–∞–Ω—Å–∞ —á–µ—Ä–µ–∑ PointsHelper
- [x] –ü–æ–ª—É—á–µ–Ω–∏–µ customer_id –ø–æ user_id –∏–∑ `#__radicalmart_customers`
- [x] –ë–ª–æ–∫ –±–∞–ª–ª–æ–≤ –≤ `tmpl/profile/default.php` —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- [x] –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç –≤ —Ä—É–±–ª—è—Ö —á–µ—Ä–µ–∑ `PointsHelper::convertToMoney()`
- [x] –Ø–∑—ã–∫–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏: POINTS_UNIT, VIEW_HISTORY, POINTS_HISTORY, REFERRALS, GUEST

#### 1.2 –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏ –±–∞–ª–ª–æ–≤
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-28)

**–†–µ—à–µ–Ω–∏—è –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º**:
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è: –∫–Ω–æ–ø–∫–∞ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë" (10 –∑–∞–ø–∏—Å–µ–π)
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞: –ø—Ä–æ—Å—Ç–æ–π —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫
- –°–≥–æ—Ä–∞—é—â–∏–µ –±–∞–ª–ª—ã: –æ—Ç–¥–µ–ª—å–Ω—ã–π –±–ª–æ–∫ –≤–≤–µ—Ä—Ö—É (–µ—Å–ª–∏ –µ—Å—Ç—å –±–∞–ª–ª—ã —Å –¥–∞—Ç–æ–π –æ–∫–æ–Ω—á–∞–Ω–∏—è)
- –§–∏–ª—å—Ç—Ä: –Ω–µ –Ω—É–∂–µ–Ω, –æ–±—â–∏–π —Å–ø–∏—Å–æ–∫

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:
- [x] `View/Points/HtmlView.php` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ + —Å–≥–æ—Ä–∞—é—â–∏—Ö –±–∞–ª–ª–æ–≤
- [x] `View/Points/JsonView.php` ‚Äî AJAX endpoint –¥–ª—è "–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë"
- [x] `tmpl/points/default.php` ‚Äî —Å–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π
- [x] –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –≤–≤–µ—Ä—Ö—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- [x] –ë–ª–æ–∫ "–°–≥–æ—Ä–∞—é—â–∏–µ –±–∞–ª–ª—ã" (–µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞–ø–∏—Å–∏ —Å end > NOW())
- [x] –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" –∫ –ø—Ä–æ—Ñ–∏–ª—é
- [x] –Ø–∑—ã–∫–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏: POINTS_BALANCE, POINTS_EXPIRING, POINTS_EXPIRES_DATE, POINTS_NO_HISTORY, –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–π

#### 1.3 –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–ª–ª–æ–≤ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-28)

**–†–µ—à–µ–Ω–∏—è –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º**:
- UI: –ø–æ–ª–µ –≤–≤–æ–¥–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏ +/- –ò —á–µ–∫–±–æ–∫—Å "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ –±–∞–ª–ª—ã"
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ RadicalMart Bonuses (–±–µ–∑ –¥–æ–ø. –ª–∏–º–∏—Ç–æ–≤)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Ç–æ–≥–∞: –ø–æ –∫–Ω–æ–ø–∫–µ "–ü—Ä–∏–º–µ–Ω–∏—Ç—å"
- –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å–µ–∫—Ü–∏—è "–°–∫–∏–¥–∫–∏ –∏ –±–∞–ª–ª—ã" –ø–µ—Ä–µ–¥ –±–ª–æ–∫–æ–º "–ò—Ç–æ–≥–æ" (—Ä—è–¥–æ–º —Å –ø—Ä–æ–º–æ–∫–æ–¥–æ–º)

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:
- [x] –°–µ–∫—Ü–∏—è "–°–∫–∏–¥–∫–∏ –∏ –±–∞–ª–ª—ã" –≤ `tmpl/checkout/default.php`
- [x] –ü–æ–ª–µ –≤–≤–æ–¥–∞ –±–∞–ª–ª–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏ +/‚àí –∏ —á–µ–∫–±–æ–∫—Å "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ"
- [x] –ü–æ–∫–∞–∑ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–∞ –≤ —Ä—É–±–ª—è—Ö
- [x] –ö–Ω–æ–ø–∫–∞ "–ü—Ä–∏–º–µ–Ω–∏—Ç—å" ‚Üí AJAX —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Å–µ—Å—Å–∏—é RadicalMart
- [x] `ApiController::applyPoints()` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `com_radicalmart.checkout.data['plugins']['bonuses']['points']`
- [x] –ü–ª–∞–≥–∏–Ω `radicalmart/bonuses` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏ createOrder
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã—Ö –±–∞–ª–ª–æ–≤ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
- [x] –Ø–∑—ã–∫–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏: DISCOUNTS_POINTS, USE_ALL_POINTS, POINTS_APPLIED, POINTS_CLEARED

---

### –≠—Ç–∞–ø 2: –ü—Ä–æ–º–æ–∫–æ–¥—ã

#### 2.1 –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞ –≤ checkout
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-28)

**–†–µ—à–µ–Ω–∏—è –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º**:
- –û–¥–∏–Ω –ø—Ä–æ–º–æ–∫–æ–¥ –∑–∞ —Ä–∞–∑ (–∫–∞–∫ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–∞–π—Ç–µ)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª–∏ —Å–∫–∏–¥–∫–∏ –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
- –ö–Ω–æ–ø–∫–∞ "–ü—Ä–∏–º–µ–Ω–∏—Ç—å" –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–¥

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:
- [x] –ü–æ–ª–µ –≤–≤–æ–¥–∞ –ø—Ä–æ–º–æ–∫–æ–¥–∞ –≤ —Å–µ–∫—Ü–∏–∏ "–°–∫–∏–¥–∫–∏ –∏ –±–∞–ª–ª—ã"
- [x] `ApiController::applyPromo()` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ `CodesHelper::checkCode()`
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `com_radicalmart.checkout.data['plugins']['bonuses']['codes']`
- [x] –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞: —É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞, —Ä–∞–∑–º–µ—Ä —Å–∫–∏–¥–∫–∏
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
- [x] –Ø–∑—ã–∫–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏: PROMO, ENTER_PROMO, APPLY, PROMO_APPLIED, ERR_PROMO_*

#### 2.2 –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-28)

**–†–µ—à–µ–Ω–∏—è –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º**:
- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Å—Ç—ë–∫—à–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã (—Å–µ—Ä—ã–º, —Å –ø–æ–º–µ—Ç–∫–æ–π "–ò—Å—Ç—ë–∫")
- –ö–Ω–æ–ø–∫–∞ "–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥" —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π —É—Å–ø–µ—Ö–∞ –∏ Telegram haptic feedback
- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ç–æ–≤–∞—Ä–∞–º/–∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (apply = "–¥–µ–π—Å—Ç–≤—É–µ—Ç –Ω–∞", ignore = "–Ω–µ –¥–µ–π—Å—Ç–≤—É–µ—Ç –Ω–∞")

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:
- [x] `View/Codes/HtmlView.php` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ `#__radicalmart_bonuses_codes`
- [x] `tmpl/codes/default.php` ‚Äî –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π UI —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ: –∫–æ–¥, —Å–∫–∏–¥–∫–∞ (%-—è –∏–ª–∏ —Ñ–∏–∫—Å), —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- [x] –°—Ç–∞—Ç—É—Å—ã: "–ê–∫—Ç–∏–≤–µ–Ω" (–∑–µ–ª—ë–Ω—ã–π), "–ò—Å—Ç—ë–∫" (–∫—Ä–∞—Å–Ω—ã–π), "–õ–∏–º–∏—Ç –∏—Å—á–µ—Ä–ø–∞–Ω" (–∂—ë–ª—Ç—ã–π)
- [x] –ë–ª–æ–∫ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ —Ç–æ–≤–∞—Ä–∞–º/–∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏–∑ plugins JSON
- [x] –ö–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Å clipboard API –∏ fallback
- [x] Telegram WebApp –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (BackButton, haptic feedback)
- [x] –°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è (–∏–∫–æ–Ω–∫–∞ tag)
- [x] –Ø–∑—ã–∫–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏: PROMO_CODES, CODES_EMPTY, CODE_*, COPY_CODE, COPIED

---

### –≠—Ç–∞–ø 3: –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞

#### 3.1 –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-28)

**–†–µ—à–µ–Ω–∏—è –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º**:
- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ —Å **–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏** –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ (email: `j***n@g***l.com`)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—É–º–º—É –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –±–∞–ª–ª–æ–≤ –æ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ (–∏–∑ –ª–æ–≥–æ–≤)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–Ω—É—é —Ü–µ–ø–æ—á–∫—É —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ (–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è, –¥–æ 5 —É—Ä–æ–≤–Ω–µ–π –≤–Ω–∏–∑)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ü–µ–ø–æ—á–∫—É —Ä–æ–¥–∏—Ç–µ–ª–µ–π (–∫—Ç–æ –ø—Ä–∏–≥–ª–∞—Å–∏–ª, –≤–≤–µ—Ä—Ö)

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:
- [x] `View/Referrals/HtmlView.php` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã
- [x] `tmpl/referrals/default.php` ‚Äî –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π UI
- [x] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ + –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –±–∞–ª–ª—ã (–≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±–ª–æ–∫)
- [x] –ë–ª–æ–∫ "–ú–æ–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –∫–æ–¥—ã" —Å –∫–Ω–æ–ø–∫–æ–π –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Å—ã–ª–∫–∏
- [x] –ë–ª–æ–∫ "–ö—Ç–æ –º–µ–Ω—è –ø—Ä–∏–≥–ª–∞—Å–∏–ª" ‚Äî —Ü–µ–ø–æ—á–∫–∞ —Ä–æ–¥–∏—Ç–µ–ª–µ–π
- [x] –ë–ª–æ–∫ "–ú–æ–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—ã" ‚Äî –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –¥–µ—Ä–µ–≤–æ —Å —Ü–≤–µ—Ç–æ–≤—ã–º–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏
- [x] –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ email –¥–ª—è –∑–∞—â–∏—Ç—ã –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
- [x] –ü–∞–≥–∏–Ω–∞—Ü–∏—è "–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë"
- [x] –°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —É–∂–µ –±—ã–ª–∞ –≤ –ø—Ä–æ—Ñ–∏–ª–µ
- [x] –Ø–∑—ã–∫–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏: REFERRALS_*, CODE_*, COPY, COPIED

#### 3.2 –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-28)

**–†–µ—à–µ–Ω–∏—è –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º**:
- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–¥–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã (–Ω–µ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–¥, —Å—Å—ã–ª–∫—É –ò —Ä–∞–∑–º–µ—Ä —Å–∫–∏–¥–∫–∏ –æ—Ç —à–∞–±–ª–æ–Ω–∞
- –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞: —Å–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ª–∏–º–∏—Ç–µ

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:
- [x] `HtmlView.php` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–≤–æ–π—Å—Ç–≤–∞: `$canCustomCode`, `$codesLimit`, `$codesLimitReached`, `$templateDiscount`
- [x] `HtmlView::checkCanCreateCode()` ‚Äî —É–ª—É—á—à–µ–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- [x] `HtmlView::loadTemplateDiscount()` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Å–∫–∏–¥–∫–∏ –∏–∑ —à–∞–±–ª–æ–Ω–∞ –∫–æ–¥–∞
- [x] `ApiController::createReferralCode()` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ `ReferralsModel::createCode()`
- [x] –§–æ—Ä–º–∞ –≤ `tmpl/referrals/default.php`:
  - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∫–∏–¥–∫–µ –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞
  - –ü–æ–ª–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–¥–∞ (–µ—Å–ª–∏ `canCustomCode`)
  - –ö–Ω–æ–ø–∫–∞ "–°–æ–∑–¥–∞—Ç—å –∫–æ–¥" ‚Üí AJAX
  - –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞: –∫–æ–¥, —Å—Å—ã–ª–∫–∞, —Å–∫–∏–¥–∫–∞ + –∫–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
  - –°–æ–æ–±—â–µ–Ω–∏–µ –æ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ–º –ª–∏–º–∏—Ç–µ –∫–æ–¥–æ–≤
- [x] JavaScript —Ñ—É–Ω–∫—Ü–∏–∏: `createReferralCode()`, `copyNewCodeLink()`
- [x] –Ø–∑—ã–∫–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏: CREATE_NEW_CODE, CODE_WILL_GIVE, ENTER_CUSTOM_CODE –∏ –¥—Ä.

#### 3.3 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π
**–°—Ç–∞—Ç—É—Å**: ‚è≥ –û–∂–∏–¥–∞–µ—Ç
**–í–æ–ø—Ä–æ—Å—ã –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º**:
- [ ] –§–æ—Ä–º–∞—Ç —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏: `t.me/bot?start=ref_CODE` –∏–ª–∏ —á–µ—Ä–µ–∑ —Å–∞–π—Ç?
- [ ] –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–æ–≤–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –ø–æ —Ä–µ—Ñ. —Å—Å—ã–ª–∫–µ?
- [ ] –ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤—è–∑—å: –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ –∏–ª–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–∫–∞–∑–µ?

**–ó–∞–¥–∞—á–∏**:
- [ ] –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞ –ø–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–µ (`/start ref_XXXX`):
  - –ò–∑–≤–ª–µ—á—å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥
  - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Å–µ—Å—Å–∏–∏/–∫—É–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–≤—è–∑–∫–∏ user‚Üîtelegram —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–¥
- [ ] –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–∫–∞–∑–µ:
  - –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥
  - `ReferralHelper::createReferralRelationship()` —Å–æ–∑–¥–∞—Å—Ç —Å–≤—è–∑—å
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Telegram —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏:
  - –§–æ—Ä–º–∞—Ç: `https://t.me/bot_name?start=ref_USERCODE`
  - –ü–æ–∫–∞–∑–∞—Ç—å –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã

---

### –≠—Ç–∞–ø 4: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram

#### 4.1 –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–∏ –±–∞–ª–ª–æ–≤
- [ ] –†–∞—Å—à–∏—Ä–∏—Ç—å `plg_radicalmart_message_telegram` –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
- [ ] –°–ª—É—à–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ `onRadicalMartAfterChangeOrderStatus`
- [ ] –ü—Ä–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–∏ –±–∞–ª–ª–æ–≤ (—Å—Ç–∞—Ç—É—Å "–í—ã–ø–æ–ª–Ω–µ–Ω") –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ:
  - "üéÅ –í–∞–º –Ω–∞—á–∏—Å–ª–µ–Ω–æ X –±–∞–ª–ª–æ–≤ –∑–∞ –∑–∞–∫–∞–∑ ‚ÑñY"
  - "–í–∞—à –±–∞–ª–∞–Ω—Å: Z –±–∞–ª–ª–æ–≤ (= N ‚ÇΩ)"

#### 4.2 –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–º –±–æ–Ω—É—Å–µ
- [ ] –ü—Ä–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö –±–∞–ª–ª–æ–≤ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—é:
  - "üë• –í–∞—à —Ä–µ—Ñ–µ—Ä–∞–ª —Å–æ–≤–µ—Ä—à–∏–ª –∑–∞–∫–∞–∑! –í–∞–º –Ω–∞—á–∏—Å–ª–µ–Ω–æ X –±–∞–ª–ª–æ–≤"

#### 4.3 –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –±–∞–ª–ª–æ–≤
- [ ] Scheduled task –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–≥–æ—Ä–∞—é—â–∏—Ö –±–∞–ª–ª–æ–≤
- [ ] –ó–∞ N –¥–Ω–µ–π –¥–æ —Å–≥–æ—Ä–∞–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ

---

### –≠—Ç–∞–ø 5: –£–ª—É—á—à–µ–Ω–∏—è UX

#### 5.1 –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∫—ç—à–±—ç–∫–∞
- [ ] –í –∫–∞—Ä—Ç–æ—á–∫–µ —Ç–æ–≤–∞—Ä–∞ –ø–æ–∫–∞–∑–∞—Ç—å "–ö—ç—à–±—ç–∫: X –±–∞–ª–ª–æ–≤"
- [ ] –í –∫–æ—Ä–∑–∏–Ω–µ –ø–æ–∫–∞–∑–∞—Ç—å "–ó–∞ —ç—Ç–æ—Ç –∑–∞–∫–∞–∑ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ X –±–∞–ª–ª–æ–≤"
- [ ] –§–æ—Ä–º—É–ª–∞ —á–µ—Ä–µ–∑ `PointsHelper::calculatePoints()`

#### 5.2 –í–∏–¥–∂–µ—Ç –±–∞–ª–∞–Ω—Å–∞ –≤ header
- [ ] –ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å –±–∞–ª–ª–æ–≤ –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ WebApp
- [ ] –ö–ª–∏–∫ ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –±–∞–ª–ª–æ–≤

#### 5.3 –®–∞—Ä–∏–Ω–≥ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏
- [ ] –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" ‚Üí Telegram native share
- [ ] –ì–æ—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç —Å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–æ–π
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Telegram.WebApp.openTelegramLink()` –¥–ª—è inline share

---

### –≠—Ç–∞–ø 6: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

#### 6.1 –ü—Ä–æ—Å–º–æ—Ç—Ä –±–∞–ª–ª–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞ (admin)
- [ ] –í –¥–µ—Ç–∞–ª—è—Ö –∑–∞–∫–∞–∑–∞ –ø–æ–∫–∞–∑–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –±–∞–ª–ª—ã
- [ ] –í –ø—Ä–æ—Ñ–∏–ª–µ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å –∏ –∏—Å—Ç–æ—Ä–∏—é

---

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### MVP (Minimum Viable Product)
1. ‚úÖ –ë–∞–ª–∞–Ω—Å –±–∞–ª–ª–æ–≤ –≤ –ø—Ä–æ—Ñ–∏–ª–µ
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–ª–ª–æ–≤ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏
3. ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏
4. ‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã

### –§–∞–∑–∞ 2
5. –ò—Å—Ç–æ—Ä–∏—è –±–∞–ª–ª–æ–≤
6. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö –∫–æ–¥–æ–≤
7. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram start –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º
8. Telegram-—Å—Å—ã–ª–∫–∏ –¥–ª—è —à–∞—Ä–∏–Ω–≥–∞

### –§–∞–∑–∞ 3
9. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –±–∞–ª–ª–∞—Ö
10. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞—Ö
11. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫—ç—à–±—ç–∫–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
12. –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ —Å–≥–æ—Ä–∞–Ω–∏–∏ –±–∞–ª–ª–æ–≤

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–º–µ—Ç–∫–∏

### –ü–æ–ª—É—á–µ–Ω–∏–µ customer_id
```php
// RadicalMart –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ—é —Ç–∞–±–ª–∏—Ü—É customers
// customer_id != user_id
// –ü–æ–ª—É—á–∏—Ç—å customer_id —á–µ—Ä–µ–∑ user_id:
$db = Factory::getContainer()->get('DatabaseDriver');
$query = $db->getQuery(true)
    ->select('id')
    ->from('#__radicalmart_customers')
    ->where('user_id = ' . (int) $userId);
$customerId = $db->setQuery($query)->loadResult();
```

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞ –¥–ª—è –±–∞–ª–ª–æ–≤/–∫–æ–¥–æ–≤
–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ –ø–µ—Ä–µ–¥–∞—Ç—å –≤ `$data`:
```php
$data['bonuses_points'] = 100; // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤ –∫ —Å–ø–∏—Å–∞–Ω–∏—é
$data['bonuses_codes'] = ['PROMOCODE1', 'REFCODE2']; // –º–∞—Å—Å–∏–≤ –∫–æ–¥–æ–≤
```

### –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ –≤ –∫—É–∫–∏
```php
// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (–ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –ø–æ —Å—Å—ã–ª–∫–µ)
CodesHelper::setCookieCode('REFCODE');

// –£–¥–∞–ª–µ–Ω–∏–µ
CodesHelper::removeCookieCode();
```

### –°–æ–±—ã—Ç–∏—è –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- `onRadicalMartBonusesBeforeCalculateProductsDiscounts`
- `onRadicalMartBonusesCalculateProductsDiscounts`
- `onRadicalMartBonusesGetPointsProviders`
- `onRadicalMartBonusesGetCodesProviders`

---

## –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã
- `src/View/Points/HtmlView.php`
- `src/View/Codes/HtmlView.php`
- `src/View/Referrals/HtmlView.php`
- `tmpl/points/default.php`
- `tmpl/codes/default.php`
- `tmpl/referrals/default.php`

### –ò–∑–º–µ–Ω–µ–Ω–∏—è
- `src/View/Profile/HtmlView.php` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å –±–∞–ª–ª–æ–≤
- `tmpl/profile/default.php` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–ª—ã, —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `tmpl/checkout/default.php` ‚Äî –ø–æ–ª—è –±–∞–ª–ª–æ–≤ –∏ –ø—Ä–æ–º–æ–∫–æ–¥–∞
- `src/Helper/TelegramUserHelper.php` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ –∏–∑ start

### –Ø–∑—ã–∫–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏
- `COM_RADICALMART_TELEGRAM_POINTS` = "–ë–∞–ª–ª—ã"
- `COM_RADICALMART_TELEGRAM_POINTS_BALANCE` = "–í–∞—à –±–∞–ª–∞–Ω—Å"
- `COM_RADICALMART_TELEGRAM_POINTS_EQUIVALENT` = "–≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç"
- `COM_RADICALMART_TELEGRAM_PROMOCODE` = "–ü—Ä–æ–º–æ–∫–æ–¥"
- `COM_RADICALMART_TELEGRAM_PROMOCODE_APPLY` = "–ü—Ä–∏–º–µ–Ω–∏—Ç—å"
- `COM_RADICALMART_TELEGRAM_PROMOCODE_INVALID` = "–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥"
- `COM_RADICALMART_TELEGRAM_REFERRAL` = "–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞"
- `COM_RADICALMART_TELEGRAM_REFERRAL_CODE` = "–í–∞—à —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥"
- `COM_RADICALMART_TELEGRAM_REFERRAL_LINK` = "–í–∞—à–∞ —Å—Å—ã–ª–∫–∞"
- `COM_RADICALMART_TELEGRAM_REFERRAL_COUNT` = "–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ –¥—Ä—É–∑–µ–π"
- `COM_RADICALMART_TELEGRAM_REFERRAL_EARNED` = "–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –±–∞–ª–ª–æ–≤"
- `COM_RADICALMART_TELEGRAM_PAY_WITH_POINTS` = "–û–ø–ª–∞—Ç–∏—Ç—å –±–∞–ª–ª–∞–º–∏"
- `COM_RADICALMART_TELEGRAM_POINTS_TO_USE` = "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–ª–ª–æ–≤"
